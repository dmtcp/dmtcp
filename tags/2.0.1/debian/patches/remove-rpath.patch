Description: Remove RPATH for libdmtcp.so
 Not needed for binary package.

--- a/dmtcp/src/Makefile.am
+++ b/dmtcp/src/Makefile.am
@@ -75,10 +75,7 @@
 # 1. ../                : Useful when installed with 'make DESTDIR=xxx install'
 # 2. $ORIGIN/../../mtcp : Useful when running from build directory
 # 3. $(libdir)          : Useful when installed with 'make install'
-libdmtcp_so_LDFLAGS = -shared -L../../mtcp \
-		      -Xlinker -rpath -Xlinker ../ \
-		      -Xlinker -rpath -Xlinker '$$ORIGIN/../../mtcp' \
-		      -Xlinker -rpath -Xlinker $(libdir)
+libdmtcp_so_LDFLAGS = -shared -L../../mtcp
 
 #dmtcp_nocheckpoint_LDFLAGS = -static
 
--- a/dmtcp/src/Makefile.in
+++ b/dmtcp/src/Makefile.in
@@ -366,10 +366,7 @@
 # 1. ../                : Useful when installed with 'make DESTDIR=xxx install'
 # 2. $ORIGIN/../../mtcp : Useful when running from build directory
 # 3. $(libdir)          : Useful when installed with 'make install'
-libdmtcp_so_LDFLAGS = -shared -L../../mtcp \
-		      -Xlinker -rpath -Xlinker ../ \
-		      -Xlinker -rpath -Xlinker '$$ORIGIN/../../mtcp' \
-		      -Xlinker -rpath -Xlinker $(libdir)
+libdmtcp_so_LDFLAGS = -shared -L../../mtcp
 
 
 #dmtcp_nocheckpoint_LDFLAGS = -static
--- a/test/autotest.py
+++ b/test/autotest.py
@@ -297,6 +297,10 @@
 os.system("rm -f "+tmpfile)
 
 os.environ['DMTCP_GZIP'] = GZIP
+if os.getenv('LD_LIBRARY_PATH'):
+    os.environ['LD_LIBRARY_PATH'] += ':' + os.getenv("PWD")+"/lib"
+else:
+    os.environ['LD_LIBRARY_PATH'] = os.getenv("PWD")+"/lib"
 
 #launch the coordinator
 coordinator = launch(BIN+"dmtcp_coordinator")
